class local2json{constructor(a){this.name=a,this.tables=[],this.triggers=[],localStorage.getItem(a)&&(this.tables=JSON.parse(localStorage.getItem(a)))}Save(){localStorage.setItem(this.name,JSON.stringify(this.tables))}createTable(a){const b=this.tables.length;for(let c=0;c<b;c++)if(this.tables[c].name==a)return!1;return this.tables.push({name:a,data:[],index:this.tables.length}),this.Save(),!0}getTable(a){let b={items:[],index:0};const c=this.tables.length;for(let d=0;d<c;d++)if(this.tables[d].name==a){b.items=this.tables[d].data,b.index=d;break}return b}existTable(a){let b=!1;const c=this.tables.length;for(let d=0;d<c;d++)if(this.tables[d].name==a){b=!0;break}return b}updateTable(a,b){const c=this.tables.length;for(let d=0;d<c;d++)if(this.tables[d].name==a)return this.tables[d].data=b,this.Save(),!0;return!1}deleteTable(a){const b=this.tables.length;for(let c=0;c<b;c++)if(this.tables[c].name==a)return tables.splice(c,1),this.Save(),!0;return!1}insert(a,b){const c=this.tables.length;for(let d=0;d<c;d++)if(this.tables[d].name==a){for(let c in this.tables[d].data.push(b),this.Save(),this.triggers)this.triggers[c].table==a&&"insert"==this.triggers[c].event&&this.triggers[c].fun();return!0}return!1}ClearObject(a){let b=JSON.stringify(a),c="";return b=b.replace("{",""),b=b.replace("}",""),Array.from(b).map(a=>{"\""!=a&&"\\"!=a&&(c+=a)}),c}IsValidQuestion(a,b,c){let d=!1;return"=="===a?d=b==c:"==="===a?d=b===c:"<"===a?d=b<c:"<="===a?d=b<=c:">"===a?d=b>c:">="===a?d=b>=c:"!="===a?d=b!=c:"%%"===a?d=-1<c.indexOf(b):void 0,d}get(a,b){const c=this.getTable(a),d=c.items.length;let e=[];const f=b.split(" ",10)[0],g=b.split(" ",10)[2],h=b.split(" ",10)[1];for(let j=0;j<d;j++){const a=this.ClearObject(c.items[j]),b=a.split(",",500);for(let a=0;a<b.length;a++)if(b[a].split(":")[0]==f){const d=b[a].split(":")[1];this.IsValidQuestion(h,g,d)&&(e.push(c.items[j]),a=b.length)}}return e}delete(a,b){const c=this.getTable(a),d=c.items.length;const e=b.split(" ",10)[0],f=b.split(" ",10)[2],g=b.split(" ",10)[1];for(let h=0;h<d;h++){const b=this.ClearObject(c.items[h]),d=b.split(",",500);for(let b=0;b<d.length;b++)if(d[b].split(":")[0]==e){const e=d[b].split(":")[1];if(this.IsValidQuestion(g,f,e)){this.tables[c.index].data[h];for(let b in this.tables[c.index].data.splice(c[h],1),this.Save(),this.triggers)this.triggers[b].table==a&&"delete"==this.triggers[b].event&&this.triggers[b].fun();return!0}}}return!1}update(a,b,c){const d=this.getTable(a),e=d.items.length;const f=b.split(" ",10)[0],g=b.split(" ",10)[2],h=b.split(" ",10)[1];for(let j=0;j<e;j++){const b=this.ClearObject(d.items[j]),e=b.split(",",500);for(let b=0;b<e.length;b++)if(e[b].split(":")[0]==f){const f=e[b].split(":")[1];if(this.IsValidQuestion(h,g,f)){for(let b in this.tables[d.index].data[j]=c,this.Save(),this.triggers)this.triggers[b].table==a&&"update"==this.triggers[b].event&&this.triggers[b].fun();return!0}}}return!1}trigger(a,b,c){this.triggers.push({table:a,event:b,fun:c})}}